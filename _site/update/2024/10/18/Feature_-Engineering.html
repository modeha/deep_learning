<!DOCTYPE html>
<html lang="en"><head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Deep Learning" /></head>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<style>@import url(/public/css/syntax/monokai.css);</style>
  <title>Deep Learning</title>
  <!-- <link href="/public/css/bootstrap.min.css" rel="stylesheet"> -->

  <link href="/public/css/style.css" rel="stylesheet">
  <body>
  	<div class="container"> 
		<div class="sidebar">
			<div class="sidebar-item sidebar-header">
	<div class='sidebar-brand'>
		<a href="/about/">Deep Learning</a>
	</div>
	<p class="lead">Mohsen Dehghani</p></div>

<div class="sidebar-item sidebar-nav">
	<ul class="nav">
      <li class="nav-title">Pages</li>
	  <li>
	  	<a class="nav-item" href="/">Articles</a>
	  </li>
	  
	  
	    
	  
	    
	      
	        <li>
	        	<a class="nav-item" href="/about/">
	            	About
	            </a>
	        </li>
	      
	    
	  
	    
	      
	    
	  
	    
	  
	    
	  
	</ul>
</div>

<div class="sidebar-item sidebar-nav">
  	<ul class="nav">
			<li class="nav-title">Categories</li>
	    
	    <li>
	    	<a class="nav-item" href="/category/#Update">
				<span class="name">Update</span>
				<span class="badge">11</span>
	    	</a>
 		</li>
	    
	    <li>
	    	<a class="nav-item" href="/category/#update">
				<span class="name">update</span>
				<span class="badge">6</span>
	    	</a>
 		</li>
	    
	    <li>
	    	<a class="nav-item" href="/category/#Jekyll">
				<span class="name">Jekyll</span>
				<span class="badge">1</span>
	    	</a>
 		</li>
	    
	  </nav>
	</ul>
</div>

<div class="sidebar-item sidebar-footer">
	<p>Powered by <a href="https://github.com/jekyll/jekyll">Jekyll</a></p>
</div>
		</div>
		<div class="content">
			<article class="post">
	<header class="post-header">
		<div class="post-title"> 
			Python Packages Specialize for Feature Engineering Techniques
		</div>
		<time class="post-date dt-published" datetime="2024-10-18T20:31:29-04:00" itemprop="datePublished">2024/10/18
		</time>		
	</header>

	<div class="post-content">
		<h3 id="python-packages-specialize-for-feature-engineering-techniques">Python Packages Specialize for Feature Engineering Techniques</h3>
<p>Several Python packages specialize in feature engineering techniques, which can help automate tasks like encoding, scaling, generating interaction features, or extracting domain-specific features. Here are some popular feature engineering packages and examples of how to use them:</p>

<h3 id="1-feature-engine">1. <strong>Feature-engine</strong></h3>

<p>Feature-engine provides a variety of feature engineering techniques, including encoding, variable transformation, feature creation, and feature selection. It integrates well with scikit-learn and allows you to create pipelines with ease.</p>

<h4 id="example-with-feature-engine">Example with Feature-engine</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">feature_engine.encoding</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">feature_engine.imputation</span> <span class="kn">import</span> <span class="n">MeanMedianImputer</span>
<span class="kn">from</span> <span class="nn">feature_engine.transformation</span> <span class="kn">import</span> <span class="n">PowerTransformer</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># Load your dataset
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"your_dataset.csv"</span><span class="p">)</span>

<span class="c1"># Example pipeline for feature engineering
# 1. Fill missing values in numeric columns
</span><span class="n">imputer</span> <span class="o">=</span> <span class="n">MeanMedianImputer</span><span class="p">(</span><span class="n">imputation_method</span><span class="o">=</span><span class="s">"mean"</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s">"numerical_column"</span><span class="p">])</span>
<span class="n">df_imputed</span> <span class="o">=</span> <span class="n">imputer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 2. Apply one-hot encoding to categorical columns
</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s">"categorical_column"</span><span class="p">])</span>
<span class="n">df_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_imputed</span><span class="p">)</span>

<span class="c1"># 3. Apply power transformation to normalize skewed distributions
</span><span class="n">transformer</span> <span class="o">=</span> <span class="n">PowerTransformer</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s">"numerical_column"</span><span class="p">])</span>
<span class="n">df_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_encoded</span><span class="p">)</span>

<span class="n">df_transformed</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="2-featuretools">2. <strong>Featuretools</strong></h3>

<p>Featuretools is a library for automated feature engineering, especially useful for relational datasets (i.e., datasets with multiple tables). It uses a technique called “Deep Feature Synthesis” to automatically create new features based on relationships and aggregations.</p>

<h4 id="example-with-featuretools">Example with Featuretools</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">featuretools</span> <span class="k">as</span> <span class="n">ft</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># Load data
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"your_dataset.csv"</span><span class="p">)</span>

<span class="c1"># Create an EntitySet and add the dataframe
</span><span class="n">es</span> <span class="o">=</span> <span class="n">ft</span><span class="p">.</span><span class="n">EntitySet</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s">"dataset"</span><span class="p">)</span>
<span class="n">es</span> <span class="o">=</span> <span class="n">es</span><span class="p">.</span><span class="n">entity_from_dataframe</span><span class="p">(</span><span class="n">entity_id</span><span class="o">=</span><span class="s">"data"</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s">"index_column"</span><span class="p">)</span>

<span class="c1"># Perform deep feature synthesis to automatically create new features
</span><span class="n">features</span><span class="p">,</span> <span class="n">feature_defs</span> <span class="o">=</span> <span class="n">ft</span><span class="p">.</span><span class="n">dfs</span><span class="p">(</span><span class="n">entityset</span><span class="o">=</span><span class="n">es</span><span class="p">,</span> <span class="n">target_entity</span><span class="o">=</span><span class="s">"data"</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">features</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="3-tsfresh-for-time-series-data">3. <strong>tsfresh</strong> (for Time Series Data)</h3>

<p><code class="highlighter-rouge">tsfresh</code> is a great package for extracting features from time series data. It provides a comprehensive set of feature extraction functions tailored for time series, like statistical metrics and frequency domain transformations.</p>

<h4 id="example-with-tsfresh">Example with tsfresh</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tsfresh</span> <span class="kn">import</span> <span class="n">extract_features</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># Assuming your dataset is in a long format with columns "id", "time", and "value"
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s">"id"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s">"time"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s">"value"</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Extract features
</span><span class="n">extracted_features</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_id</span><span class="o">=</span><span class="s">"id"</span><span class="p">,</span> <span class="n">column_sort</span><span class="o">=</span><span class="s">"time"</span><span class="p">)</span>

<span class="n">extracted_features</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="4-scikit-learn-pipelines-with-featureunion">4. <strong>Scikit-learn Pipelines with FeatureUnion</strong></h3>

<p>For basic feature engineering in scikit-learn, the <code class="highlighter-rouge">FeatureUnion</code> module allows you to combine multiple feature engineering steps, like scaling, polynomial features, and encoding, into a single pipeline.</p>

<h4 id="example-with-scikit-learn-pipelines">Example with Scikit-learn Pipelines</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span><span class="p">,</span> <span class="n">FeatureUnion</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># Load your dataset
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"your_dataset.csv"</span><span class="p">)</span>

<span class="c1"># Example feature engineering pipeline
</span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s">"features"</span><span class="p">,</span> <span class="n">FeatureUnion</span><span class="p">([</span>
        <span class="p">(</span><span class="s">"poly_features"</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span>
        <span class="p">(</span><span class="s">"scaler"</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
    <span class="p">]))</span>
<span class="p">])</span>

<span class="c1"># Fit and transform the dataset
</span><span class="n">X_transformed</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s">"numerical_column"</span><span class="p">]])</span>

<span class="n">X_transformed</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="5-kats-for-time-series">5. <strong>Kats</strong> (for Time Series)</h3>

<p>Kats, developed by Facebook, offers advanced feature engineering for time series data, including trend detection, seasonal decomposition, anomaly detection, and feature extraction.</p>

<h4 id="example-with-kats">Example with Kats</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">kats.tsfeatures.tsfeatures</span> <span class="kn">import</span> <span class="n">TsFeatures</span>
<span class="kn">from</span> <span class="nn">kats.consts</span> <span class="kn">import</span> <span class="n">TimeSeriesData</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># Example time series data
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s">"time"</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2020-01-01"</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">"D"</span><span class="p">),</span>
    <span class="s">"value"</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1"># Convert to Kats TimeSeriesData format
</span><span class="n">ts_data</span> <span class="o">=</span> <span class="n">TimeSeriesData</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Initialize Kats features and calculate
</span><span class="n">ts_features</span> <span class="o">=</span> <span class="n">TsFeatures</span><span class="p">()</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">ts_features</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ts_data</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</code></pre></div></div>

<p>These packages offer a wide range of feature engineering capabilities, from automated feature extraction to custom transformations for specific data types. You can choose the best one depending on your dataset and the type of features you want to generate.</p>

	</div>
</article>
		</div>
	</div>
  </body>
</html>